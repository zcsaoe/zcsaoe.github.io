<!doctype html><html class=position-relative itemscope itemtype=https://schema.org/WebPage lang=zh-hans data-bs-theme=auto><head><script src=/assets/init/bundle.min.397129316ebf5d0138f2a6eb945afea462097722c2aadea2126a46958286b68a.js integrity="sha256-OXEpMW6/XQE48qbrlFr+pGIJdyLCqt6iEmpGlYKGtoo=" crossorigin=anonymous></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Router -</title><link rel=icon href=/favicon_hu_34f9c9faf91b627e.webp sizes=16x16 type=image/webp><link rel=icon href=/favicon_hu_39d7e2e00a977bd3.webp sizes=32x32 type=image/webp><link rel=icon href=/favicon_hu_3b58e88b4b286a78.webp sizes=150x150 type=image/webp><link rel=apple-touch-icon href=/favicon_hu_3598ad0641f7f3c3.webp sizes=180x180 type=image/webp><link rel=icon href=/favicon_hu_144910b52c989e57.webp sizes=192x192 type=image/webp><link rel=mask-icon href=/safari-pinned-tab.svg color=#6f42c1><meta name=keywords content="Hugo,Bootstrap,博客主题"><meta name=description content="网络相关的配置，操作等"><meta name=robots content="index, follow"><meta name=twitter:card content="summary"><meta name=twitter:title content="Router"><meta name=twitter:description content="网络相关的配置，操作等"><meta property="og:url" content="https://6668688.xyz/docs/misc/router/"><meta property="og:title" content="Router"><meta property="og:description" content="网络相关的配置，操作等"><meta property="og:locale" content="zh_hans"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-08-02T11:54:30+08:00"><meta property="article:modified_time" content="2025-11-10T19:54:50+08:00"><meta itemprop=name content="Router"><meta itemprop=description content="网络相关的配置，操作等"><meta itemprop=datePublished content="2025-08-02T11:54:30+08:00"><meta itemprop=dateModified content="2025-11-10T19:54:50+08:00"><meta itemprop=wordCount content="2824"><meta itemprop=keywords content="Router"><meta property="og:image" content="https://6668688.xyz/images/Mascot.webp"><meta name=twitter:image content="https://6668688.xyz/images/Mascot.webp"><meta property="og:image:alt" content="Router"><meta name=twitter:image:alt content="Router"><link rel=manifest href=/manifest.json><script async src="https://www.googletagmanager.com/gtag/js?id=G-M4F16E8H84"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M4F16E8H84")}</script><link data-precache rel=stylesheet href="/assets/main/bundle.min.261bc3dfcf5bf3b2682ba859aadc77dce4869872e35ccac3851e9fd7d8300735.css" integrity="sha256-JhvD389b87JoK6hZqtx33OSGmHLjXMrDhR6f19gwBzU=" crossorigin=anonymous><link data-precache rel=stylesheet href=/assets/viewer/bundle.min.16d2c85c4cae39a98f8cb7a977e95e554b174f91a5484c32605637156f49ca6b.css integrity="sha256-FtLIXEyuOamPjLepd+leVUsXT5GlSEwyYFY3FW9Jyms=" crossorigin=anonymous></head><body><header class="mb-4 sticky-top"><nav class="top-app-bar shadow navbar navbar-expand-xxl"><div class=container><button class="navbar-toggler border-0" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDocsNav aria-expanded=false aria-label="Toggle docs navigation">
<i class="fas fa-bars"></i>
</button>
<a class="navbar-brand d-flex align-items-center flex-grow-1 flex-xxl-grow-0 justify-content-xxl-start justify-content-center ms-2 ms-xxl-0 mx-auto me-xxl-2" href=https://6668688.xyz/><picture><img class=logo alt=Logo src="https://6668688.xyz/images/Mascot.webp?v=193fae5f32044b1d21fc508f06b6cb46" loading=lazy width=400 height=400></picture></a><div class="offcanvas-xxl offcanvas-end flex-grow-1" data-bs-scroll=true tabindex=-1 id=navbarMenus aria-labelledby=navbarMenusLabel><div class="offcanvas-header px-4 pb-0"><div class="offcanvas-title h5" id=navbarMenusLabel></div><button type=button class="btn-close btn-close-white" data-bs-dismiss=offcanvas data-bs-target=#navbarMenus aria-label=Close></button></div><div class="offcanvas-body p-4 pt-0 p-xxl-0"><hr class=d-xxl-none><ul class="navbar-nav flex-row flex-wrap align-items-center me-auto"><li class="nav-item col-6 col-xxl-auto"><a class="nav-link py-2 px-0 px-xxl-2" href=https://6668688.xyz/onlinetools/>Online Tools</a></li></ul><hr class=d-xxl-none><form class="search-bar ms-auto my-auto" action=/search/ novalidate><div class="input-group align-items-center"><span class="btn btn-search disabled position-absolute left-0 border-0 px-1"><i class="fas fa-fw fa-search fa-lg"></i>
</span><input class="my-1 form-control border-white rounded-5 search-input bg-body" name=q type=search placeholder=搜索 aria-label=Search required>
<span class="search-shortcut position-absolute end-0 top-0 me-2"><kbd class="text-dark bg-white opacity-75 rounded-3 shadow border border-primary py-1 fw-bold">/</kbd></span></div></form><hr class=d-xxl-none><ul class="navbar-nav flex-row flex-wrap align-items-center ms-md-auto"><li class="nav-item py-2 py-xxl-1 col-12 col-xxl-auto"><nav class="social-links nav justify-content-center flex-row"><a class="nav-link social-link col-6 col-xxl-auto p-1" target=_blank href=https://github.com/zcsaoe title=GitHub rel=me><i class="fa-fw fab fa-github"></i>
<span class="ms-1 d-xxl-none">Github</span></a></nav></li><li class="nav-item py-2 py-xxl-1 col-12 col-xxl-auto"><div class="vr d-none d-xxl-flex h-100 mx-xxl-2 text-white"></div><hr class="d-xxl-none my-2"></li><li class="nav-item dropdown py-1 py-xxl-1 col-6 col-xxl-auto"><a class="nav-link px-0 px-xxl-1" href=# id=languageDropdown role=button data-bs-toggle=dropdown aria-expanded=false><i class="fas fa-fw fa-globe"></i>
<span class=d-xxl-none>语言</span></a><ul class="language-dropdown-menu dropdown-menu dropdown-menu-end" aria-labelledby=languageDropdown><li><a class=dropdown-item href=/en/>English</a></li><li><a class="dropdown-item active" href=/>简体中文</a></li></ul></li><li class="nav-item py-1 col-12 col-xxl-auto"><div class="vr d-none d-xxl-flex h-100 mx-xxl-2 text-white"></div><hr class="d-xxl-none my-2"></li><li class="nav-item dropdown col-6 col-xxl-auto"><a class="nav-link px-0 py-2 px-xxl-1" href=# id=fontSizeDropdown role=button data-bs-toggle=dropdown aria-expanded=false><i class="fas fa-fw fa-font"></i>
<span class=d-xxl-none>字体大小</span></a><ul class="font-size-dropdown-menu dropdown-menu dropdown-menu-end" aria-labelledby=fontSizeDropdown><li><button class="font-size-item dropdown-item" data-size=xs>
特小号</button></li><li><button class="font-size-item dropdown-item" data-size=sm>
小号</button></li><li><button class="font-size-item dropdown-item active" data-size=md>
中等</button></li><li><button class="font-size-item dropdown-item" data-size=lg>
大号</button></li><li><button class="font-size-item dropdown-item" data-size=xl>
特大号</button></li></ul></li><li class="nav-item dropdown col-6 col-xxl-auto"><a class="nav-link px-0 py-2 px-xxl-1" href=# id=paletteDropdown role=button data-bs-toggle=dropdown aria-expanded=false><i class="fas fa-fw fa-palette"></i>
<span class=d-xxl-none>配色</span></a><ul class="palette-dropdown-menu dropdown-menu dropdown-menu-end px-2 row g-2" aria-labelledby=paletteDropdown><li class="col-4 my-1"><a role=button id=palette-blue aria-label=蓝色 class="btn btn-sm w-100 palette text-bg-blue" data-palette=blue></a></li><li class="col-4 my-1"><a role=button id=palette-blue-gray aria-label=蓝灰色 class="btn btn-sm w-100 palette text-bg-blue-gray" data-palette=blue-gray></a></li><li class="col-4 my-1"><a role=button id=palette-brown aria-label=棕色 class="btn btn-sm w-100 palette text-bg-brown" data-palette=brown></a></li><li class="col-4 my-1"><a role=button id=palette-cyan aria-label=青色 class="btn btn-sm w-100 palette text-bg-cyan" data-palette=cyan></a></li><li class="col-4 my-1"><a role=button id=palette-green aria-label=绿色 class="btn btn-sm w-100 palette text-bg-green" data-palette=green></a></li><li class="col-4 my-1"><a role=button id=palette-indigo aria-label=靛青色 class="btn btn-sm w-100 palette text-bg-indigo" data-palette=indigo></a></li><li class="col-4 my-1"><a role=button id=palette-orange aria-label=橙色 class="btn btn-sm w-100 palette text-bg-orange" data-palette=orange></a></li><li class="col-4 my-1"><a role=button id=palette-pink aria-label=粉色 class="btn btn-sm w-100 palette text-bg-pink" data-palette=pink></a></li><li class="col-4 my-1"><a role=button id=palette-purple aria-label=紫色 class="btn btn-sm w-100 palette text-bg-purple" data-palette=purple></a></li><li class="col-4 my-1"><a role=button id=palette-red aria-label=红色 class="btn btn-sm w-100 palette text-bg-red" data-palette=red></a></li><li class="col-4 my-1"><a role=button id=palette-teal aria-label=蓝绿色 class="btn btn-sm w-100 palette text-bg-teal" data-palette=teal></a></li><li class="col-4 my-1"><a role=button id=palette-yellow aria-label=黄色 class="btn btn-sm w-100 palette text-bg-yellow" data-palette=yellow></a></li></ul></li><li class="nav-item dropdown col-6 col-xxl-auto"><a class="nav-link px-0 py-2 px-xxl-1" href=# id=modeDropdown role=button data-bs-toggle=dropdown aria-expanded=false><i class="mode-icon fas fa-fw fa-adjust" id=modeIcon></i>
<span class=d-xxl-none>模式</span></a><ul class="mode-dropdown-menu dropdown-menu dropdown-menu-end" aria-labelledby=modeDropdown><li class=mode-item data-color-mode=light data-icon=sun><button class=dropdown-item>
<i class="mode-icon fas fa-fw fa-sun"></i> 浅色</button></li><li class=mode-item data-color-mode=dark data-icon=moon><button class=dropdown-item>
<i class="mode-icon fas fa-fw fa-moon"></i> 深色</button></li><li class="mode-item active" data-color-mode=auto data-icon=adjust><button class=dropdown-item>
<i class="mode-icon fas fa-fw fa-adjust"></i> 自动</button></li></ul></li></ul></div></div><div class=d-flex><button class="navbar-toggler order-5 border-0" type=button data-bs-toggle=offcanvas data-bs-target=#navbarMenus aria-controls=navbarMenus aria-expanded=false aria-label="Toggle navigation">
<i class="fas fa-ellipsis-h"></i></button></div></div></nav></header><main class="container has-sidebar" data-kind=page><script data-precache src=/js/main-init.fd48d66afb2d9a122b72b40b25ebae1b1338abcace96dbd4220b429bd5f5541d.js integrity="sha256-/UjWavstmhIrcrQLJeuuGxM4q8rOltvUIgtCm9X1VB0=" crossorigin=anonymous></script><div class="row content"><noscript><div class="alert alert-danger" role=alert>你的浏览器不支持 JavaScript。</div></noscript><aside class="docs-nav col-xxl-2" tabindex=-1 data-bs-hide=focusout><div class="offcanvas-xxl offcanvas-start" id=offcanvasDocsNav aria-labelledby=offcanvasDocsNavLabel><div class="offcanvas-header border-bottom"><div class="offcanvas-title h5" id=offcanvasDocsNavLabel>浏览文档</div><button type=button class=btn-close data-bs-dismiss=offcanvas aria-label=Close data-bs-target=#offcanvasDocsNav></button></div><div class="offcanvas-body pt-2 flex-column"><ul class="list-unstyled mb-2 w-100"><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/autosar/autosar/><span class=docs-nav-title>Autosar</span></a></li><li class=mb-2 tabindex=-1><div class="py-1 d-flex justify-content-between align-items-center"><a class="docs-nav-link d-flex align-items-center" href=/docs/cpu/><span class=docs-nav-title>cpu</span></a>
<a class="btn-toggle ms-1 collapsed" role=button data-bs-toggle=collapse data-bs-target=#nav-43cee4cb2ebee90cdb2b8ca8044577bf aria-expanded=false aria-controls=nav-43cee4cb2ebee90cdb2b8ca8044577bf><i class="btn-toggle-icon fas fa-chevron-down ms-auto" data-fa-transform=rotate-270></i></a></div><div class="docs-nav-subnavs border-start mt-2 collapse" id=nav-43cee4cb2ebee90cdb2b8ca8044577bf><div class="btn-toggle-nav fw-normal ms-2 small"><ul class="list-unstyled mb-2 w-100"><li class=mb-2 tabindex=-1><div class="py-1 d-flex justify-content-between align-items-center"><a class="docs-nav-link d-flex align-items-center" href=/docs/cpu/arm/><span class=docs-nav-title>arm</span></a>
<a class="btn-toggle ms-1 collapsed" role=button data-bs-toggle=collapse data-bs-target=#nav-7a03c27cee416496e05a62ea9433788b aria-expanded=false aria-controls=nav-7a03c27cee416496e05a62ea9433788b><i class="btn-toggle-icon fas fa-chevron-down ms-auto" data-fa-transform=rotate-270></i></a></div><div class="docs-nav-subnavs border-start mt-2 collapse" id=nav-7a03c27cee416496e05a62ea9433788b><div class="btn-toggle-nav fw-normal ms-2 small"><ul class="list-unstyled mb-2 w-100"><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/cpu/arm/armv7-qemu/><span class=docs-nav-title>Armv7 Qemu</span></a></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/cpu/arm/cortex-r/cortex-r52/cortex-r52/><span class=docs-nav-title>Cortex-R52</span></a></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/cpu/arm/imx6ull-freertos/><span class=docs-nav-title>Imx6ull FreeRTOS</span></a></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/cpu/arm/j6m/><span class=docs-nav-title>J6M</span></a></li></ul></div></div></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/cpu/flagchip/flagchip/><span class=docs-nav-title>Flagchip</span></a></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/cpu/hex/><span class=docs-nav-title>Hex</span></a></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/cpu/state_machine/><span class=docs-nav-title>State_machine</span></a></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/cpu/trace32/><span class=docs-nav-title>TRACE32使用教程</span></a></li><li class=mb-2 tabindex=-1><div class="py-1 d-flex justify-content-between align-items-center"><a class="docs-nav-link d-flex align-items-center" href=/docs/cpu/tricore/><span class=docs-nav-title>tricore</span></a>
<a class="btn-toggle ms-1 collapsed" role=button data-bs-toggle=collapse data-bs-target=#nav-1f3d9527be3ac31576d7acaa74855ffa aria-expanded=false aria-controls=nav-1f3d9527be3ac31576d7acaa74855ffa><i class="btn-toggle-icon fas fa-chevron-down ms-auto" data-fa-transform=rotate-270></i></a></div><div class="docs-nav-subnavs border-start mt-2 collapse" id=nav-1f3d9527be3ac31576d7acaa74855ffa><div class="btn-toggle-nav fw-normal ms-2 small"><ul class="list-unstyled mb-2 w-100"><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/cpu/tricore/ads/><span class=docs-nav-title>Ads</span></a></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/cpu/tricore/sota/><span class=docs-nav-title>Ota</span></a></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/cpu/tricore/tc397/><span class=docs-nav-title>Tc397</span></a></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/cpu/tricore/tc397_interrupt/><span class=docs-nav-title>Tc397中断子系统</span></a></li></ul></div></div></li></ul></div></div></li><li class=mb-2 tabindex=-1><div class="py-1 d-flex justify-content-between align-items-center"><a class="docs-nav-link d-flex align-items-center" href=/docs/dds/><span class=docs-nav-title>DDS</span></a>
<a class="btn-toggle ms-1 collapsed" role=button data-bs-toggle=collapse data-bs-target=#nav-00d405d37f8b4497a5196e63c7c5fd7b aria-expanded=false aria-controls=nav-00d405d37f8b4497a5196e63c7c5fd7b><i class="btn-toggle-icon fas fa-chevron-down ms-auto" data-fa-transform=rotate-270></i></a></div><div class="docs-nav-subnavs border-start mt-2 collapse" id=nav-00d405d37f8b4497a5196e63c7c5fd7b><div class="btn-toggle-nav fw-normal ms-2 small"><ul class="list-unstyled mb-2 w-100"><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/dds/dds/><span class=docs-nav-title>DDS</span></a></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/dds/mvbs/><span class=docs-nav-title>mvbs</span></a></li></ul></div></div></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/bus/dsi3/><span class=docs-nav-title>Dsi3</span></a></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/hello/><span class=docs-nav-title>Hello</span></a></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/markdown/markdown/><span class=docs-nav-title>Markdown</span></a></li><li class=mb-2 tabindex=-1><div class="py-1 d-flex justify-content-between align-items-center text-primary"><a class="docs-nav-link d-flex align-items-center" href=/docs/misc/><span class=docs-nav-title>misc</span></a>
<a class="btn-toggle ms-1" role=button data-bs-toggle=collapse data-bs-target=#nav-887556bd011b7e588d0294d8266ab478 aria-expanded=true aria-controls=nav-887556bd011b7e588d0294d8266ab478><i class="btn-toggle-icon fas fa-chevron-down ms-auto" data-fa-transform=rotate-270></i></a></div><div class="docs-nav-subnavs border-start mt-2 collapse show" id=nav-887556bd011b7e588d0294d8266ab478><div class="btn-toggle-nav fw-normal ms-2 small"><ul class="list-unstyled mb-2 w-100"><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/misc/hugo/><span class=docs-nav-title>Hugo</span></a></li><li class="mb-2 py-1 text-primary border-2 border-start border-primary ps-2 docs-nav-active-item" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/misc/router/><span class=docs-nav-title>Router</span></a></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/misc/teslamate/><span class=docs-nav-title>Teslamate</span></a></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/misc/investment/funds/><span class=docs-nav-title>货币基金</span></a></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/misc/bootable_usb/><span class=docs-nav-title>系统安装</span></a></li></ul></div></div></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/doraemon/><span class=docs-nav-title>懒人技术手册</span></a></li><li class="mb-2 py-1" tabindex=-1><a class="docs-nav-link d-flex align-items-center" href=/docs/linux/shell/terminalshortcutkeys/><span class=docs-nav-title>终端快捷键</span></a></li></ul></div></div></aside><div class="col ms-auto content-docs"><div class=container-fluid><nav class="row card component" aria-label=breadcrumb><div class="card-body pb-0"><ol class="hbs-breadcrumb breadcrumb flex-nowrap"><li class="breadcrumb-item text-surface"><a href=/>主页</a></li><li class="breadcrumb-item text-surface"><a href=/docs/>docs</a></li><li class="breadcrumb-item text-surface"><a href=/docs/misc/>misc</a></li><li class="breadcrumb-item active">Router</li></ol></div></nav><div class="post-panel-wrapper position-relative d-flex justify-content-center"><div class="d-flex flex-row justify-content-center rounded-5 border post-panel position-fixed px-3 py-1 surface shadow-1"><a class="action action-toc d-block d-xxl-none" href=#post-toc-container role=button title=目录><i class="fas fa-fw fa-list-alt"></i>
</a><a class="action action-copyright" href=#post-copyright role=button aria-label=Copyright title=版权><i class="fas fa-fw fa-copyright"></i>
</a><a class="action action-post-comments" href=#post-comments role=button aria-label=Comments title=评论><i class="fas fa-fw fa-comments"></i>
</a><a id=sidebarToggler class="action action-sidebar-toggler d-none d-xxl-block" role=button title=切换侧边栏><i class="fas fa-fw fa-expand-alt" data-fa-transform=rotate-45></i></a></div></div><article class="row card component mb-4 post"><div class=card-header><h1 class="card-title post-title my-2">Router</h1></div><div class=card-body><div class="post-meta mb-3"><span class="post-date me-1 mb-1" title="创建于 2025-08-02 03:54:30 +0000 UTC，更新于 2025-11-10 11:54:50 +0000 UTC。">2025年8月2日</span><span class="post-reading-time me-1 mb-1">6 分钟阅读</span>
<span class="post-lastmod me-1 mb-1 text-muted">更新于 2025年11月10日
</span><a href=/series/router/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-series"><i class="fas fa-fw fa-columns me-1"></i>Router</a></div><div class="mt-2 mb-3 d-block d-xxl-none"><h2 class="text-surface mb-3">目录</h2><div id=post-toc-container></div><hr class=text-secondary></div><div class="post-content mb-3" data-bs-spy=scroll data-bs-target=#TableOfContents tabindex=0><div id=post-content-body><p>网络相关的配置，操作等</p><h2 id=常用命令 data-numberify>常用命令<a class="anchor ms-1" href=#常用命令></a></h2><blockquote><p>ifdown wan; ifup wan<br>cat /proc/net/nf_conntrack 查看链接</p></blockquote><h3 id=iptable data-numberify>iptable<a class="anchor ms-1" href=#iptable></a></h3><blockquote><p>filter nat mangle raw security<br>iptables -t nat -L input_rule -n -v &ndash;line-numbers<br>iptables -D input_rule 2<br>iptables -F input_rule<br>iptables -t nat -A POSTROUTING -s 172.22.22.0/24 -d 192.168.1.0/24 -j MASQUERADE<br>iptables -I FORWARD 1 -s 192.168.1.100 -p udp &ndash;sport 30000:40000 -j DROP</p></blockquote><h2 id=wireguard data-numberify>wireguard<a class="anchor ms-1" href=#wireguard></a></h2><blockquote><p><a href=https://www.wireguard.com/install/ target=_blank rel="noopener noreferrer">install<i class="fas fa-external-link-square-alt ms-1"></i></a><br><a href=https://download.wireguard.com/windows-client/ target=_blank rel="noopener noreferrer">windows-client<i class="fas fa-external-link-square-alt ms-1"></i></a><br><a href=https://www.wireguard.com/quickstart/ target=_blank rel="noopener noreferrer">quickstart<i class="fas fa-external-link-square-alt ms-1"></i></a></p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=ln> 1</span><span class=cl>sudo apt install wireguard
</span></span><span class=line><span class=ln> 2</span><span class=cl>sudo sed -i <span class=s1>&#39;s/.*net\.ipv4\.ip_forward.*/net.ipv4.ip_forward = 1/&#39;</span> /etc/sysctl.conf
</span></span><span class=line><span class=ln> 3</span><span class=cl>sysctl -p
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=nb>cd</span> /etc/wireguard
</span></span><span class=line><span class=ln> 5</span><span class=cl>wg genkey <span class=p>|</span> tee server_privatekey <span class=p>|</span> wg pubkey &gt; server_publickey
</span></span><span class=line><span class=ln> 6</span><span class=cl>wg genkey <span class=p>|</span> tee client_privatekey <span class=p>|</span> wg pubkey &gt; client_publickey
</span></span><span class=line><span class=ln> 7</span><span class=cl>
</span></span><span class=line><span class=ln> 8</span><span class=cl><span class=nb>echo</span> <span class=s2>&#34;
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=s2>[Interface]
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=s2>PrivateKey = </span><span class=k>$(</span>cat server_privatekey<span class=k>)</span><span class=s2>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=s2>Address = 10.0.8.1/24
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=s2>PostUp   = iptables -A FORWARD -i wg0 -j ACCEPT; iptables -A FORWARD -o wg0 -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=s2>PostDown = iptables -D FORWARD -i wg0 -j ACCEPT; iptables -D FORWARD -o wg0 -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=s2>ListenPort = port
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=s2># DNS = 1.1.1.1
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=s2>[Peer]
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=s2>PublicKey =  </span><span class=k>$(</span>cat client_publickey<span class=k>)</span><span class=s2>
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=s2>AllowedIPs = 10.0.8.100/32 &#34;</span> &gt; wg0.conf
</span></span><span class=line><span class=ln>19</span><span class=cl>&gt; eth0 根据情况适配，一定是当前使用的网卡的，否则无法访问局域网内的其他设备  
</span></span><span class=line><span class=ln>20</span><span class=cl>&gt; 如有线、无线切换的时候注意更改  
</span></span><span class=line><span class=ln>21</span><span class=cl>&gt; NAT port1 -&gt; port2  
</span></span><span class=line><span class=ln>22</span><span class=cl>
</span></span><span class=line><span class=ln>23</span><span class=cl>sudo systemctl <span class=nb>enable</span> wg-quick@wg0
</span></span><span class=line><span class=ln>24</span><span class=cl><span class=c1># 启动WireGuard</span>
</span></span><span class=line><span class=ln>25</span><span class=cl>wg-quick up wg0
</span></span><span class=line><span class=ln>26</span><span class=cl><span class=c1># 停止WireGuard</span>
</span></span><span class=line><span class=ln>27</span><span class=cl>wg-quick down wg0
</span></span><span class=line><span class=ln>28</span><span class=cl><span class=c1># 查看wireguard服务端运行状态</span>
</span></span><span class=line><span class=ln>29</span><span class=cl>wg
</span></span><span class=line><span class=ln>30</span><span class=cl>
</span></span><span class=line><span class=ln>31</span><span class=cl><span class=nb>echo</span> <span class=s2>&#34;
</span></span></span><span class=line><span class=ln>32</span><span class=cl><span class=s2>[Interface]
</span></span></span><span class=line><span class=ln>33</span><span class=cl><span class=s2>  PrivateKey = </span><span class=k>$(</span>cat client_privatekey<span class=k>)</span><span class=s2>
</span></span></span><span class=line><span class=ln>34</span><span class=cl><span class=s2>  Address = 10.0.8.100/32
</span></span></span><span class=line><span class=ln>35</span><span class=cl><span class=s2>  DNS = 1.1.1.1
</span></span></span><span class=line><span class=ln>36</span><span class=cl><span class=s2>[Peer]
</span></span></span><span class=line><span class=ln>37</span><span class=cl><span class=s2>  PublicKey = </span><span class=k>$(</span>cat server_publickey<span class=k>)</span><span class=s2>
</span></span></span><span class=line><span class=ln>38</span><span class=cl><span class=s2>  Endpoint = ip:port
</span></span></span><span class=line><span class=ln>39</span><span class=cl><span class=s2>  AllowedIPs = 10.0.8.0/24, 172.22.22.0/24
</span></span></span><span class=line><span class=ln>40</span><span class=cl><span class=s2>  PersistentKeepalive = 25 &#34;</span> &gt; client.conf
</span></span><span class=line><span class=ln>41</span><span class=cl>
</span></span><span class=line><span class=ln>42</span><span class=cl>
</span></span><span class=line><span class=ln>43</span><span class=cl>sudo ufw allow port/udp
</span></span><span class=line><span class=ln>44</span><span class=cl>sudo ufw allow ssh
</span></span><span class=line><span class=ln>45</span><span class=cl>sudo ufw <span class=nb>enable</span>
</span></span><span class=line><span class=ln>46</span><span class=cl>sudo ufw status
</span></span><span class=line><span class=ln>47</span><span class=cl>
</span></span><span class=line><span class=ln>48</span><span class=cl><span class=c1># 测试端口</span>
</span></span><span class=line><span class=ln>49</span><span class=cl>nc -u IP port
</span></span><span class=line><span class=ln>50</span><span class=cl>
</span></span><span class=line><span class=ln>51</span><span class=cl>grep <span class=s2>&#34;Failed password&#34;</span> /var/log/auth.log</span></span></code></pre></div><h3 id=openwrt data-numberify>openwrt<a class="anchor ms-1" href=#openwrt></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=ln> 1</span><span class=cl>opkg install wireguard-tools kmod-wireguard luci-proto-wireguard luci-app-wireguard
</span></span><span class=line><span class=ln> 2</span><span class=cl>
</span></span><span class=line><span class=ln> 3</span><span class=cl>cat /etc/config/network
</span></span><span class=line><span class=ln> 4</span><span class=cl>config interface <span class=s1>&#39;wg0&#39;</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>        option proto <span class=s1>&#39;wireguard&#39;</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>        option private_key <span class=s1>&#39;xxx&#39;</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>        list addresses <span class=s1>&#39;10.0.0.2/32&#39;</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>        list dns <span class=s1>&#39;1.1.1.1&#39;</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>
</span></span><span class=line><span class=ln>10</span><span class=cl>config wireguard_wg0
</span></span><span class=line><span class=ln>11</span><span class=cl>        option description <span class=s1>&#39;导入对端配置&#39;</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>        option public_key <span class=s1>&#39;xxx&#39;</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>        list allowed_ips <span class=s1>&#39;10.0.0.0/24&#39;</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>        list allowed_ips <span class=s1>&#39;10.1.0.0/24&#39;</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>        option persistent_keepalive <span class=s1>&#39;25&#39;</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>        option endpoint_host <span class=s1>&#39;domain.com&#39;</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>        option endpoint_port <span class=s1>&#39;port&#39;</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>        option route_allowed_ips <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=ln>19</span><span class=cl>
</span></span><span class=line><span class=ln>20</span><span class=cl>cat /etc/config/firewall
</span></span><span class=line><span class=ln>21</span><span class=cl>config zone
</span></span><span class=line><span class=ln>22</span><span class=cl>        option name <span class=s1>&#39;lan&#39;</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>        option input <span class=s1>&#39;ACCEPT&#39;</span>
</span></span><span class=line><span class=ln>24</span><span class=cl>        option output <span class=s1>&#39;ACCEPT&#39;</span>
</span></span><span class=line><span class=ln>25</span><span class=cl>        option forward <span class=s1>&#39;ACCEPT&#39;</span>
</span></span><span class=line><span class=ln>26</span><span class=cl>        list network <span class=s1>&#39;lan&#39;</span>
</span></span><span class=line><span class=ln>27</span><span class=cl>        list network <span class=s1>&#39;wg0&#39;</span>
</span></span><span class=line><span class=ln>28</span><span class=cl>
</span></span><span class=line><span class=ln>29</span><span class=cl><span class=c1># 防火墙配置all局域网设备通过 wg</span>
</span></span><span class=line><span class=ln>30</span><span class=cl>config zone
</span></span><span class=line><span class=ln>31</span><span class=cl>    option name <span class=s1>&#39;wg&#39;</span>
</span></span><span class=line><span class=ln>32</span><span class=cl>    option input <span class=s1>&#39;ACCEPT&#39;</span>
</span></span><span class=line><span class=ln>33</span><span class=cl>    option output <span class=s1>&#39;ACCEPT&#39;</span>
</span></span><span class=line><span class=ln>34</span><span class=cl>    option forward <span class=s1>&#39;REJECT&#39;</span>
</span></span><span class=line><span class=ln>35</span><span class=cl>    option masq <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=ln>36</span><span class=cl>    option mtu_fix <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=ln>37</span><span class=cl>    list network <span class=s1>&#39;wg0&#39;</span>
</span></span><span class=line><span class=ln>38</span><span class=cl>
</span></span><span class=line><span class=ln>39</span><span class=cl>config forwarding
</span></span><span class=line><span class=ln>40</span><span class=cl>    option src <span class=s1>&#39;lan&#39;</span>
</span></span><span class=line><span class=ln>41</span><span class=cl>    option dest <span class=s1>&#39;wg&#39;</span>
</span></span><span class=line><span class=ln>42</span><span class=cl>
</span></span><span class=line><span class=ln>43</span><span class=cl><span class=c1># 防火墙配置部分设备通过 wg</span>
</span></span><span class=line><span class=ln>44</span><span class=cl><span class=c1># https://openwrt.org/docs/guide-user/firewall/firewall_configuration</span>
</span></span><span class=line><span class=ln>45</span><span class=cl>
</span></span><span class=line><span class=ln>46</span><span class=cl>config zone
</span></span><span class=line><span class=ln>47</span><span class=cl>    option name <span class=s1>&#39;wg&#39;</span>
</span></span><span class=line><span class=ln>48</span><span class=cl>    option input <span class=s1>&#39;ACCEPT&#39;</span>
</span></span><span class=line><span class=ln>49</span><span class=cl>    option output <span class=s1>&#39;ACCEPT&#39;</span>
</span></span><span class=line><span class=ln>50</span><span class=cl>    option forward <span class=s1>&#39;REJECT&#39;</span>
</span></span><span class=line><span class=ln>51</span><span class=cl>    option masq <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=ln>52</span><span class=cl>    option mtu_fix <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=ln>53</span><span class=cl>    list network <span class=s1>&#39;wg0&#39;</span>
</span></span><span class=line><span class=ln>54</span><span class=cl>
</span></span><span class=line><span class=ln>55</span><span class=cl><span class=c1>#config forwarding</span>
</span></span><span class=line><span class=ln>56</span><span class=cl><span class=c1>#    option src &#39;lan&#39;</span>
</span></span><span class=line><span class=ln>57</span><span class=cl><span class=c1>#    option dest &#39;wg&#39;</span>
</span></span><span class=line><span class=ln>58</span><span class=cl>
</span></span><span class=line><span class=ln>59</span><span class=cl>config rule
</span></span><span class=line><span class=ln>60</span><span class=cl>    option name <span class=s1>&#39;allow_192_168_0_200/201_to_vpn&#39;</span>
</span></span><span class=line><span class=ln>61</span><span class=cl>    option src <span class=s1>&#39;lan&#39;</span>
</span></span><span class=line><span class=ln>62</span><span class=cl>    option src_ip <span class=s1>&#39;192.168.0.200/31&#39;</span>
</span></span><span class=line><span class=ln>63</span><span class=cl>    option dest <span class=s1>&#39;wg&#39;</span>
</span></span><span class=line><span class=ln>64</span><span class=cl>    option target <span class=s1>&#39;ACCEPT&#39;</span></span></span></code></pre></div><h3 id=nanopi-2 data-numberify>NanoPi 2<a class="anchor ms-1" href=#nanopi-2></a></h3><ul><li><p>cat /sys/devices/platform/board/info</p><ul><li>板子信息查看</li></ul></li><li><p><a href=https://wiki.friendlyelec.com/wiki/index.php/NanoPi_2/zh#.E7.BC.96.E8.AF.91_FriendlyCore.2FLubuntu.2FEFlasher.E7.9A.84.E5.86.85.E6.A0.B8.E6.BA.90.E4.BB.A3.E7.A0.81 target=_blank rel="noopener noreferrer">内核代码编译<i class="fas fa-external-link-square-alt ms-1"></i></a></p></li><li><p><a href=https://git.zx2c4.com/wireguard-linux-compat target=_blank rel="noopener noreferrer">wireguard-linux-compat<i class="fas fa-external-link-square-alt ms-1"></i></a></p><ul><li>低版本内核准备的兼容实现</li></ul></li><li><p>交叉编译工具： <a href=https://releases.linaro.org/components/toolchain/binaries/latest-7/arm-linux-gnueabihf/gcc-linaro-7.5.0-2019.12-x86_64_arm-linux-gnueabihf.tar.xz target=_blank rel="noopener noreferrer">gcc-linaro-7.5.0-2019.12-x86_64_arm-linux-gnueabihf<i class="fas fa-external-link-square-alt ms-1"></i></a></p></li><li><p>编译内核 make ARCH=arm nanopi2_linux_defconfig</p></li><li><p>编译 wireguard.ko</p></li><li><p>主要注意问题：insmode wireguard 如果有错误， dmesg 分析一下</p><ul><li>依赖另外两个 ip6_udp_tunnel.ko udp_tunnel.ko</li><li>如果不想编译的话，可以 find /usr/lib/modules/$(uname -r) 下是否有ko</li></ul></li></ul><h2 id=ddns data-numberify>ddns<a class="anchor ms-1" href=#ddns></a></h2><blockquote><p><a href=../images/router/ddns-cf-v4.sh>ddns-cf-v4.sh</a></p></blockquote><blockquote><p>config.json</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=ln>1</span><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>    <span class=nt>&#34;CFKEY&#34;</span><span class=p>:</span><span class=s2>&#34;xxxxxx&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>    <span class=nt>&#34;CFUSER&#34;</span><span class=p>:</span><span class=s2>&#34;xxx@xxx.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=nt>&#34;CFDOMAIN&#34;</span><span class=p>:[</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>        <span class=s2>&#34;xxx.yyy&#34;</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=p>}</span></span></span></code></pre></div><h2 id=shellcrash data-numberify>ShellCrash<a class="anchor ms-1" href=#shellcrash></a></h2><blockquote><p><a href=https://github.com/juewuy/ShellCrash target=_blank rel="noopener noreferrer">https://github.com/juewuy/ShellCrash<i class="fas fa-external-link-square-alt ms-1"></i></a></p></blockquote><p><a href=https://github.com/juewuy/ShellCrash/blob/dev/README_CN.md#%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85 target=_blank rel="noopener noreferrer">在线安装<i class="fas fa-external-link-square-alt ms-1"></i></a>：<em>只是引用的文件源不同</em></p><blockquote><p>0 3 * * 3 /etc/ShellCrash/task/task.sh 104 在每周3的3点整更新订阅并重启服务<br>0 3 * * 5 /etc/ShellCrash/task/task.sh 113 在每周5的3点整自动更新数据库文件</p></blockquote><h3 id=meta内核 data-numberify>meta内核<a class="anchor ms-1" href=#meta内核></a></h3><pre><code>    2-1   : 查看当前的内核
    2-1-3 : Tproxy模式
    2-1-7 : 3 劫持局域网+本机流量
    2-2   : 1 fake-ip  3 mix混合模式
    2-2-4 : 7 禁用DNS劫持，自定义dns服务器
    2-9   : Fake-ip过滤列表  /etc/ShellCrash/configs/fake_ip_filter
    4-1   : 允许ShellCrash开机启动
    5-7   : 自动保存面板配置 周3的3点整更新订阅  自动同步ntp时间
    6-1   : 订阅相关
    6-1-4 : 配置规则
    6-6-2 : 自定义规则  /etc/ShellCrash/yamls/rules.yaml
    9-4-2 : 面板  https://github.com/MetaCubeX/metacubexd  ui面板
    8-2   : 切换内核singbox
</code></pre><h3 id=config data-numberify>config<a class="anchor ms-1" href=#config></a></h3><blockquote><p>configs/ShellCrash.cfg</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln> 1</span><span class=cl>#ShellCrash配置文件，不明勿动！
</span></span><span class=line><span class=ln> 2</span><span class=cl>versionsh_l=1.9.2beta4
</span></span><span class=line><span class=ln> 3</span><span class=cl>firewall_mod=iptables
</span></span><span class=line><span class=ln> 4</span><span class=cl>update_url=https://fastly.jsdelivr.net/gh/juewuy/ShellCrash@master
</span></span><span class=line><span class=ln> 5</span><span class=cl>userguide=1
</span></span><span class=line><span class=ln> 6</span><span class=cl>redir_mod=混合模式
</span></span><span class=line><span class=ln> 7</span><span class=cl>cn_ip_route=已开启
</span></span><span class=line><span class=ln> 8</span><span class=cl>dns_nameserver=&#39;https://223.5.5.5/dns-query, https://doh.pub/dns-query, tls://dns.rubyfish.cn:853&#39;
</span></span><span class=line><span class=ln> 9</span><span class=cl>dns_fallback=&#39;https://223.5.5.5/dns-query, https://doh.pub/dns-query, tls://dns.rubyfish.cn:853&#39;
</span></span><span class=line><span class=ln>10</span><span class=cl>Https=
</span></span><span class=line><span class=ln>11</span><span class=cl>Url=&#39;https://|https://&#39;
</span></span><span class=line><span class=ln>12</span><span class=cl>cpucore=armv7
</span></span><span class=line><span class=ln>13</span><span class=cl>crashcore=meta
</span></span><span class=line><span class=ln>14</span><span class=cl>core_v=v1.19.11
</span></span><span class=line><span class=ln>15</span><span class=cl>geosite_v=20250707
</span></span><span class=line><span class=ln>16</span><span class=cl>mrs_geosite_cn_v=20250707
</span></span><span class=line><span class=ln>17</span><span class=cl>china_ip_list_v=20250707
</span></span><span class=line><span class=ln>18</span><span class=cl>china_ipv6_list_v=20250707
</span></span><span class=line><span class=ln>19</span><span class=cl>Country_v=
</span></span><span class=line><span class=ln>20</span><span class=cl>cn_mini_v=20250707
</span></span><span class=line><span class=ln>21</span><span class=cl>hostdir=&#39;:9999/ui&#39;
</span></span><span class=line><span class=ln>22</span><span class=cl># exclude=&#39;免费|计费&#39;  url 编码
</span></span><span class=line><span class=ln>23</span><span class=cl>exclude=&#39;%E8%AE%A1%E8%B4%B9%7C%E5%85%8D%E8%B4%B9&#39;
</span></span><span class=line><span class=ln>24</span><span class=cl># 6-1-5 选取在线生成服务器
</span></span><span class=line><span class=ln>25</span><span class=cl>server_link=1
</span></span><span class=line><span class=ln>26</span><span class=cl># 6-1-4 选取在线配置规则模版
</span></span><span class=line><span class=ln>27</span><span class=cl>rule_link=1</span></span></code></pre></div><h3 id=fakeip data-numberify>fakeip<a class="anchor ms-1" href=#fakeip></a></h3><blockquote><p>configs/fake_ip_filter</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln>1</span><span class=cl><span class=l>snapdrop.net</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w></span><span class=l>canyouseeme.org</span><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w></span><span class=cp>*.*.gov.cn</span></span></span></code></pre></div><h3 id=yamls data-numberify>yamls<a class="anchor ms-1" href=#yamls></a></h3><blockquote><p>yamls/rules.yaml</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln>1</span><span class=cl>- <span class=l>DOMAIN,snapdrop.net,DIRECT</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w></span>- <span class=l>DOMAIN,stun.l.google.com,DIRECT</span><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w></span>- <span class=l>DOMAIN-SUFFIX,canyouseeme.org,DIRECT</span><span class=w>
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=w></span>- <span class=l>DOMAIN-KEYWORD,spaceship,DIRECT</span><span class=w>
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=w></span>- <span class=l>DOMAIN-KEYWORD,chatgpt,AiGpt</span><span class=w>
</span></span></span><span class=line><span class=ln>6</span><span class=cl><span class=w></span>- <span class=l>DOMAIN-KEYWORD,grok.com,AiGpt</span><span class=w>
</span></span></span><span class=line><span class=ln>7</span><span class=cl><span class=w></span>- <span class=l>DOMAIN-KEYWORD,reddit.com,AiGpt</span></span></span></code></pre></div><blockquote><p>yamls/proxy-groups.yaml</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln>1</span><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>AiGpt</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>fallback</span><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;https://chatgpt.com/favicon.ico&#39;</span><span class=w> </span><span class=c># 根据情况修改</span><span class=w>
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=w>    </span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=m>300</span><span class=w>
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=w>    </span><span class=nt>proxies</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>6</span><span class=cl><span class=w>      </span>- <span class=l>新加坡A02</span><span class=w>
</span></span></span><span class=line><span class=ln>7</span><span class=cl><span class=w>      </span>- <span class=l>新加坡A03 | IEPL | x2</span></span></span></code></pre></div><h3 id=clashverge data-numberify>clashverge<a class="anchor ms-1" href=#clashverge></a></h3><p><a href=https://www.clashverge.dev/friendship.html target=_blank rel="noopener noreferrer">https://www.clashverge.dev/friendship.html<i class="fas fa-external-link-square-alt ms-1"></i></a></p><blockquote></blockquote><p><a href=https://github.com/ACL4SSR/ACL4SSR/tree/master target=_blank rel="noopener noreferrer">去广告仓库<i class="fas fa-external-link-square-alt ms-1"></i></a></p><h2 id=ax1800-pro data-numberify>ax1800 pro<a class="anchor ms-1" href=#ax1800-pro></a></h2><h3 id=刷机 data-numberify>刷机<a class="anchor ms-1" href=#刷机></a></h3><blockquote><p><a href=https://github.com/lgs2007m/Actions-OpenWrt.git target=_blank rel="noopener noreferrer">https://github.com/lgs2007m/Actions-OpenWrt.git<i class="fas fa-external-link-square-alt ms-1"></i></a><br><a href=https://github.com/lgs2007m/Actions-OpenWrt/blob/main/Tutorial/JDCloud-AX1800-Pro_AX6600-Athena.md target=_blank rel="noopener noreferrer">JDCloud-AX1800-Pro_AX6600-Athena.md<i class="fas fa-external-link-square-alt ms-1"></i></a></p></blockquote><p><picture><img class=img-fluid alt src="https://6668688.xyz/docs/misc/images/router/2025-09-18-20-16-08.png?v=193fae5f32044b1d21fc508f06b6cb46" loading=lazy width=454 height=230>
</picture><picture><img class=img-fluid alt src="https://6668688.xyz/docs/misc/images/router/2025-10-17-20-45-25.png?v=193fae5f32044b1d21fc508f06b6cb46" loading=lazy width=498 height=426></picture></p><blockquote><p>雅典娜需要T10梅花内六角<strong>带孔</strong></p></blockquote><ul><li><p>拆机，上部螺丝，底部2层螺丝</p></li><li><p>拆散热片，拆天线</p></li><li><p>短接两点和地上电，输入com口，两次重连电脑之后(等3-5s), 回车继续，红灯亮起立马按reset，然后绿灯亮松开 是打开的ram中的uboot http://192.168.1.1/ ，先刷入2181降级获取ssh，刷uboot，后续可以自主更新固件<br><picture><img class=img-fluid alt src="https://6668688.xyz/docs/misc/images/router/2025-09-18-20-16-53.png?v=193fae5f32044b1d21fc508f06b6cb46" loading=lazy width=840 height=364></picture></p></li><li><p>重新进入uboot，先按住reset然后上电，红色闪 变绿 http://192.168.1.1/ ，wan，lan口都可</p><ul><li>http://192.168.1.1/uboot.html 是可以直接刷入uboot的</li></ul></li><li><p>上传之前的旧固件（2181）即可开启老固件ssh功能</p></li><li><p>可直接刷第三方固件</p><ul><li><a href=https://dl.openwrt.ai/packages-23.05/aarch64_cortex-a53/ target=_blank rel="noopener noreferrer">https://dl.openwrt.ai/packages-23.05/aarch64_cortex-a53/<i class="fas fa-external-link-square-alt ms-1"></i></a></li><li><a href=https://fw.koolcenter.com/Lean/JDC_AX1800_Pro/ target=_blank rel="noopener noreferrer">https://fw.koolcenter.com/Lean/JDC_AX1800_Pro/<i class="fas fa-external-link-square-alt ms-1"></i></a></li></ul></li><li><p>关led灯 echo 0 | tee /sys/class/leds/led_g1/brightness</p></li><li><p>恢复跑分</p><ul><li>先op、startos安装sgdisk然后 最后一个分区有的话删除 fdisk d</li><li>sgdisk -e -n 0:0:0 -c 0:storage -t 0:1B1720DA-A8BB-4B6F-92D2-0A93AB9609CA -p /dev/mmcblk0 新建分区，重启reboot</li><li>上传之后的备份文件24-26，刷回即可</li><li>刷原厂 存储设置内置存储为本地网盘，然后直接恢复出厂，智能加速服务</li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=ln>1</span><span class=cl>dd <span class=k>if</span><span class=o>=</span>/dev/zero <span class=nv>of</span><span class=o>=</span><span class=k>$(</span>blkid -t <span class=nv>PARTLABEL</span><span class=o>=</span>0:ETHPHYFW -o device<span class=k>)</span> <span class=nv>conv</span><span class=o>=</span>fsync
</span></span><span class=line><span class=ln>2</span><span class=cl>dd <span class=k>if</span><span class=o>=</span>/mnt/mmcblk0p27/mmcblk0p24_plugin.bin <span class=nv>of</span><span class=o>=</span><span class=k>$(</span>blkid -t <span class=nv>PARTLABEL</span><span class=o>=</span>plugin -o device<span class=k>)</span> <span class=nv>conv</span><span class=o>=</span>fsync
</span></span><span class=line><span class=ln>3</span><span class=cl>dd <span class=k>if</span><span class=o>=</span>/mnt/mmcblk0p27/mmcblk0p25_log.bin <span class=nv>of</span><span class=o>=</span><span class=k>$(</span>blkid -t <span class=nv>PARTLABEL</span><span class=o>=</span>log -o device<span class=k>)</span> <span class=nv>conv</span><span class=o>=</span>fsync
</span></span><span class=line><span class=ln>4</span><span class=cl>swapoff <span class=k>$(</span>blkid -t <span class=nv>PARTLABEL</span><span class=o>=</span>swap -o device<span class=k>)</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>dd <span class=k>if</span><span class=o>=</span>/mnt/mmcblk0p27/mmcblk0p26_swap.bin <span class=nv>of</span><span class=o>=</span><span class=k>$(</span>blkid -t <span class=nv>PARTLABEL</span><span class=o>=</span>swap -o device<span class=k>)</span> <span class=nv>conv</span><span class=o>=</span>fsync
</span></span><span class=line><span class=ln>6</span><span class=cl>swapon <span class=k>$(</span>blkid -t <span class=nv>PARTLABEL</span><span class=o>=</span>swap -o device<span class=k>)</span></span></span></code></pre></div><h3 id=优化 data-numberify>优化<a class="anchor ms-1" href=#优化></a></h3><ul><li>/sbin/jd_online_upgrade.sh，disable upgrade</li><li>jd-firmware 权限 0</li><li>/etc/dropbear/authorized_keys， 600， ssh-rsa</li><li>iptables -L MINIUPNPD -v -n &ndash;line-numbers -t nat<ul><li>/etc/config/upnpd 配置黑名单没生效，/tmp/upnp.leases</li></ul></li><li>/opt/<a href=../images/router/1.5.80.r2262.zip>1.5.80.r2262</a> &ndash;> jd_h.sh</li></ul><h2 id=ax1800 data-numberify>ax1800<a class="anchor ms-1" href=#ax1800></a></h2><blockquote><p>ramips mt7621</p></blockquote><ol><li>拆机，底部三个螺丝</li><li>串口在有三颗螺丝的铝块散热器下面
<picture><img class=img-fluid alt src="https://6668688.xyz/docs/misc/images/router/2025-08-10-21-35-50.png?v=193fae5f32044b1d21fc508f06b6cb46" loading=lazy width=852 height=428></picture></li><li>波特率115200</li></ol><h3 id=串口 data-numberify>串口<a class="anchor ms-1" href=#串口></a></h3><pre>
<strong>U-Boot SPL 2018.09 (Sep 06 2022 - 22:06:27 +0800)</strong>
Trying to boot from NOR


U-Boot 2018.09 (Sep 06 2022 - 22:06:27 +0800)

CPU:   MediaTek MT7621AT ver 1, eco 3
Clocks: CPU: 880MHz, DDR: 1200MHz, Bus: 220MHz, XTAL: 40MHz
Model: MediaTek MT7621 reference board
DRAM:  448 MiB
MMC:   mmc@1e130000: 0
Loading Environment from SPI Flash... SF: Detected whxx25q128 with page size 256 Bytes, erase size 64 KiB, total 16 MiB
OK
In:    uartlite0@1e000c00
Out:   uartlite0@1e000c00
Err:   uartlite0@1e000c00
Net:
Warning: eth@1e100000 (eth0) using random MAC address - 5e:69:c8:f8:cf:5b
eth0: eth@1e100000
Saving Environment to SPI Flash... SF: Detected whxx25q128 with page size 256 Bytes, erase size 64 KiB, total 16 MiB
Erasing SPI flash...Writing to SPI flash...done
OK
<strong>disabled console and autoboot in 0 seconds</strong>
++++++++++++++upgradeFlag=<null>
rest gpio value=0 (Low Level effective)
clock is disabled (0Hz)
selecting mode MMC legacy (freq : 0 MHz)
clock is enabled (49019Hz)
selecting mode MMC legacy (freq : 25 MHz)
mmc: widths [8, 4, 1] modes [MMC legacy, MMC High Speed (26MHz), SD High Speed (50MHz), MMC High Speed (52MHz), MMC DDR52 (52MHz), HS200 (200MHz)]
host: widths [4, 1] modes [MMC legacy, SD Legacy, MMC High Speed (26MHz), SD High Speed (50MHz)]
clock is enabled (25000000Hz)
trying mode MMC High Speed (26MHz) width 4 (at 26 MHz)
selecting mode MMC High Speed (26MHz) (freq : 26 MHz)
clock is enabled (25000000Hz)
filename=backup.img
** Unable to read file backup.img **
fs_read backup.img failed
copy_form_sd failed
jdboot - goto jd boot

Usage:
jdboot
=> printenv
baudrate=115200
bootcmd=jdboot
bootcount=1
bootdelay=2
bootlimit=3
ipaddr=192.168.68.1
netmask=255.255.255.0
serverip=192.168.68.10
stderr=uartlite0@1e000c00
stdin=uartlite0@1e000c00
stdout=uartlite0@1e000c00

Environment size: 209/65532 bytes
</pre><p>连接ttl之后串口如上，无法输入命令，但是呢无法输入不代表不能进入uboot，<strong>按下reset之后上电</strong>即可在串口中输入命令, 完整操作过程如下：</p><h3 id=降级解锁ssh data-numberify>降级解锁ssh<a class="anchor ms-1" href=#降级解锁ssh></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=ln> 1</span><span class=cl>=&gt; mtkupgrade
</span></span><span class=line><span class=ln> 2</span><span class=cl>
</span></span><span class=line><span class=ln> 3</span><span class=cl>Available parts to be upgraded:
</span></span><span class=line><span class=ln> 4</span><span class=cl>    0 - Bootloader
</span></span><span class=line><span class=ln> 5</span><span class=cl>    1 - Bootloader (Advanced)
</span></span><span class=line><span class=ln> 6</span><span class=cl>    2 - Firmware
</span></span><span class=line><span class=ln> 7</span><span class=cl>
</span></span><span class=line><span class=ln> 8</span><span class=cl>Select a part: 2
</span></span><span class=line><span class=ln> 9</span><span class=cl>
</span></span><span class=line><span class=ln>10</span><span class=cl>*** Upgrading Firmware ***
</span></span><span class=line><span class=ln>11</span><span class=cl>
</span></span><span class=line><span class=ln>12</span><span class=cl>Available load methods:
</span></span><span class=line><span class=ln>13</span><span class=cl>    0 - TFTP client (Default)
</span></span><span class=line><span class=ln>14</span><span class=cl>    1 - Xmodem
</span></span><span class=line><span class=ln>15</span><span class=cl>    2 - Ymodem
</span></span><span class=line><span class=ln>16</span><span class=cl>    3 - Kermit
</span></span><span class=line><span class=ln>17</span><span class=cl>    4 - S-Record
</span></span><span class=line><span class=ln>18</span><span class=cl>
</span></span><span class=line><span class=ln>19</span><span class=cl>Select (enter for default): 0
</span></span><span class=line><span class=ln>20</span><span class=cl>
</span></span><span class=line><span class=ln>21</span><span class=cl>Input U-Boot&#39;s IP address: 192.168.68.1
</span></span><span class=line><span class=ln>22</span><span class=cl>Input TFTP server&#39;s IP address: 192.168.68.10
</span></span><span class=line><span class=ln>23</span><span class=cl>Input IP netmask: 255.255.255.0
</span></span><span class=line><span class=ln>24</span><span class=cl>Input file name: JDCOS.bin
</span></span><span class=line><span class=ln>25</span><span class=cl>
</span></span><span class=line><span class=ln>26</span><span class=cl>Using eth@1e100000 device
</span></span><span class=line><span class=ln>27</span><span class=cl>TFTP from server 192.168.68.10; our IP address is 192.168.68.1
</span></span><span class=line><span class=ln>28</span><span class=cl>Filename &#39;JDCOS.bin&#39;.
</span></span><span class=line><span class=ln>29</span><span class=cl>Load address: 0x80010000
</span></span><span class=line><span class=ln>30</span><span class=cl>Loading: T #################################################################
</span></span><span class=line><span class=ln>31</span><span class=cl>         #################################################################
</span></span><span class=line><span class=ln>32</span><span class=cl>         #################################################################
</span></span><span class=line><span class=ln>33</span><span class=cl>         #################################################################
</span></span><span class=line><span class=ln>34</span><span class=cl>         #################################################################
</span></span><span class=line><span class=ln>35</span><span class=cl>         #################################################################
</span></span><span class=line><span class=ln>36</span><span class=cl>         #################################################################
</span></span><span class=line><span class=ln>37</span><span class=cl>         #################################################################
</span></span><span class=line><span class=ln>38</span><span class=cl>         #################################################################
</span></span><span class=line><span class=ln>39</span><span class=cl>         #################################################################
</span></span><span class=line><span class=ln>40</span><span class=cl>         #################################################################
</span></span><span class=line><span class=ln>41</span><span class=cl>         #################################################################
</span></span><span class=line><span class=ln>42</span><span class=cl>         #################################################################
</span></span><span class=line><span class=ln>43</span><span class=cl>         #################################################################
</span></span><span class=line><span class=ln>44</span><span class=cl>         #################################################################
</span></span><span class=line><span class=ln>45</span><span class=cl>         #######################################
</span></span><span class=line><span class=ln>46</span><span class=cl>         1.6 MiB/s
</span></span><span class=line><span class=ln>47</span><span class=cl>done
</span></span><span class=line><span class=ln>48</span><span class=cl>Bytes transferred = 14877400 (e302d8 hex)
</span></span><span class=line><span class=ln>49</span><span class=cl>
</span></span><span class=line><span class=ln>50</span><span class=cl>*** Loaded 14877400 (0xe302d8) bytes at 0x80010000 ***
</span></span><span class=line><span class=ln>51</span><span class=cl>
</span></span><span class=line><span class=ln>52</span><span class=cl>SF: Detected whxx25q128 with page size 256 Bytes, erase size 64 KiB, total 16 MiB
</span></span><span class=line><span class=ln>53</span><span class=cl>
</span></span><span class=line><span class=ln>54</span><span class=cl>Erasing from 0x90000 to 0xecffff, size 0xe40000 ... OK
</span></span><span class=line><span class=ln>55</span><span class=cl>Writting from 0x80010000 to 0x90000, size 0xe302d8 ... OK
</span></span><span class=line><span class=ln>56</span><span class=cl>
</span></span><span class=line><span class=ln>57</span><span class=cl>*** Firmware upgrade completed! ***</span></span></code></pre></div><blockquote><p>先升级 <code>JDCOS.bin</code>(JDC03-3.1.1.r1911), 此版本网页登录解锁ssh，然后备份分区，刷写uboot <code>u-boot-mt7621-68.bin</code></p></blockquote><details><summary>备份分区，刷uboot</summary><pre>
 $.ajax({
    url: 'http://' + $.cookie("HostAddrIP") + '/jdcapi',
    async: false,
    data: JSON.stringify({
        jsonrpc: "2.0",
        id: 1,
        method: "call",
        params: [
            $.cookie("sessionid"),
            "service",
            "set",
            {
                "name": "dropbear",
                "instances": {"instance1": {"command": ["/usr/sbin/dropbear"]}}
            }
        ]
    }),
    dataType: 'json',
    type: 'POST'
})
<p>root@JDBoxV3:/tmp/123# cat /proc/mtd
dev:    size   erasesize  name
mtd0: 00040000 00010000 &ldquo;Bootloader&rdquo;
mtd1: 00010000 00010000 &ldquo;Config&rdquo;
mtd2: 00040000 00010000 &ldquo;Factory&rdquo;
mtd3: 00f70000 00010000 &ldquo;firmware&rdquo;
mtd4: 003c0000 00010000 &ldquo;kernel&rdquo;
mtd5: 00bb0000 00010000 &ldquo;rootfs&rdquo;
mtd6: 00140000 00010000 &ldquo;rootfs_data&rdquo;</p>
<p>dd if=/dev/mtd0 of=/tmp/123/mtd0_bk.bin
dd if=/dev/mtd1 of=/tmp/123/mtd1_bk.bin
dd if=/dev/mtd2 of=/tmp/123/mtd2_bk.bin
dd if=/dev/mtd3 of=/tmp/123/mtd3_bk.bin
dd if=/dev/mtd4 of=/tmp/123/mtd4_bk.bin
dd if=/dev/mtd5 of=/tmp/123/mtd5_bk.bin
dd if=/dev/mtd6 of=/tmp/123/mtd6_bk.bin</p>
<p>root@JDBoxV3:/tmp/123# mtd write u-boot-mt7621-68.bin /dev/mtd0
Unlocking /dev/mtd0 &hellip;</p>
<p>Writing from u-boot-mt7621-68.bin to /dev/mtd0 &hellip;
root@JDBoxV3:/tmp/123#
root@JDBoxV3:/tmp/123#reboot
</pre></p></details><h3 id=刷openwrt data-numberify>刷openwrt<a class="anchor ms-1" href=#刷openwrt></a></h3><p>重新进入uboot，<code>按键joy</code>上电，进入uboot，网线直连lan口，打开192.168.68.1
然后选择<code>sysupgrade.bin</code>文件刷openwrt</p><p><picture><img class=img-fluid alt src="https://6668688.xyz/docs/misc/images/router/2025-08-12-23-33-55.png?v=193fae5f32044b1d21fc508f06b6cb46" loading=lazy width=384 height=203></picture></p><h3 id=刷原厂固件 data-numberify>刷原厂固件<a class="anchor ms-1" href=#刷原厂固件></a></h3><ul><li>直接进入uboot升级原厂固件,如JDC03-3.1.1.r1911</li><li>把之前备份的分区文件重新刷回</li></ul><h2 id=ipk下载 data-numberify>ipk下载<a class="anchor ms-1" href=#ipk下载></a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=ln> 1</span><span class=cl><span class=c1># 版本架构</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>uname -a
</span></span><span class=line><span class=ln> 3</span><span class=cl>opkg print-architecture
</span></span><span class=line><span class=ln> 4</span><span class=cl>cat /proc/cpuinfo
</span></span><span class=line><span class=ln> 5</span><span class=cl>
</span></span><span class=line><span class=ln> 6</span><span class=cl><span class=c1># 根据需要修改版本架构等</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>https://downloads.openwrt.org/releases/packages-23.05/mipsel_24kc/sha256sums
</span></span><span class=line><span class=ln> 8</span><span class=cl>
</span></span><span class=line><span class=ln> 9</span><span class=cl>https://downloads.openwrt.org/releases/17.01.1/targets/ramips/mt7621/packages/kmod-wireguard_4.4.61+0.0.20170115-1_mipsel_24kc.ipk
</span></span><span class=line><span class=ln>10</span><span class=cl>https://downloads.openwrt.org/releases/17.01.1/packages/mipsel_24kc/base/iperf3_3.1.4-1_mipsel_24kc.ipk
</span></span><span class=line><span class=ln>11</span><span class=cl>
</span></span><span class=line><span class=ln>12</span><span class=cl>https://downloads.openwrt.org/snapshots/targets/
</span></span><span class=line><span class=ln>13</span><span class=cl>
</span></span><span class=line><span class=ln>14</span><span class=cl>https://dl.openwrt.ai/packages-23.05/mipsel_24kc/packages/</span></span></code></pre></div><blockquote><p>定制固件 immortalwrt, 如型号：re-cp-02，版本：23.05.6<br><a href="https://firmware-selector.immortalwrt.org/?version=23.05.6&amp;target=ramips%2Fmt7621&amp;id=jdcloud_re-cp-02" target=_blank rel="noopener noreferrer">immortalwrt-23.05.6-bf550ba2533a-ramips-mt7621-jdcloud_re-cp-02-squashfs-sysupgrade.bin<i class="fas fa-external-link-square-alt ms-1"></i></a></p></blockquote><details><summary>/etc/distfeeds.conf</summary>src/gz immortalwrt_core https://mirrors.vsean.net/openwrt/releases/23.05.6/targets/ramips/mt7621/packages
src/gz immortalwrt_base https://mirrors.vsean.net/openwrt/releases/23.05.6/packages/mipsel_24kc/base
src/gz immortalwrt_kmods https://mirrors.vsean.net/openwrt/releases/23.05.6/targets/ramips/mt7621/kmods/5.15.189-1-d57570949c8e4ee79b82936a52c330d9
src/gz immortalwrt_luci https://mirrors.vsean.net/openwrt/releases/23.05.6/packages/mipsel_24kc/luci
src/gz immortalwrt_packages https://mirrors.vsean.net/openwrt/releases/23.05.6/packages/mipsel_24kc/packages
src/gz immortalwrt_routing https://mirrors.vsean.net/openwrt/releases/23.05.6/packages/mipsel_24kc/routing
src/gz immortalwrt_telephony https://mirrors.vsean.net/openwrt/releases/23.05.6/packages/mipsel_24kc/telephony</details><blockquote><p>校验关闭 /etc/opkg.conf 文件中删除 option check_signature<br>kernel依赖问题，可以通过<a href=https://archive.openwrt.org/releases/21.02.5/targets/ramips/mt7621/packages/kernel_5.4.215-1-24ba228d1c9cc0e5974cb09dca64f48e_mipsel_24kc.ipk target=_blank rel="noopener noreferrer">升级kernel<i class="fas fa-external-link-square-alt ms-1"></i></a>解决，但是lsmod可能还是找不到</p></blockquote><h2 id=faq data-numberify>FAQ<a class="anchor ms-1" href=#faq></a></h2><h3 id=数据转发异常 data-numberify>数据转发异常<a class="anchor ms-1" href=#数据转发异常></a></h3><blockquote><p>分析配置port的流量，转发的ip是否正确，以及iptable的配置，数据流向是否正确</p></blockquote><pre>
tcpdump -i any udp port 12345
tcpdump -i eth2 host 172.22.22.12 -w test.pcap

conntrack -L | grep 12345 # 连接查看
conntrack -D -p udp --sport 12345
conntrack -D -p udp --dport 12345

iptables-save               > iptables-backup.txt
iptables -t filter -L -n    > filter.txt
iptables -t nat -L -n       > nat.txt
iptables -t mangle -L -n    > mangle.txt
iptables -t raw -L -n       > raw.txt
iptables -t security -L -n  > security.txt
</pre><h3 id=dns data-numberify>DNS<a class="anchor ms-1" href=#dns></a></h3><blockquote><p>/etc/systemd/resolved.conf</p></blockquote><pre>
[Resolve]
DNS=1.1.1.1
FallbackDNS=8.8.8.8
DNSStubListener=no
</pre><blockquote><p>sudo systemctl restart systemd-resolved</p></blockquote></div></div></div><div class=card-footer><div class="post-navs d-flex justify-content-evenly"><div class="post-nav post-prev"><i class="fas fa-fw fa-chevron-down post-prev-icon me-1" data-fa-transform=rotate-90></i>
<a href=/docs/misc/hugo/>Hugo</a></div><div class="post-nav post-next"><a href=/docs/misc/teslamate/>Teslamate</a>
<i class="fas fa-fw fa-chevron-down post-next-icon ms-1" data-fa-transform=rotate-270></i></div></div></div></article><div class="post-copyright mb-3 row card component" id=post-copyright><div class=card-header><h2 class="card-title fs-4 my-2 text-surface">版权</h2></div><div class=card-body></div></div><section class="related-posts row card component"><div class=card-header><h2 class="card-title fs-4 my-2 text-surface">相关文章</h2></div><div class="card-body slide px-1"><div class="slide-inner row gx-0"><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><div class="post-card-default-img card-img-top d-flex align-items-center justify-content-center bg-body-secondary mb-1">NO IMAGE</div><a class=post-title href=/docs/misc/hugo/>Hugo</a><div class="post-meta mb-0">2025年7月19日</div></div></div><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><picture><img class=img-fluid alt=Autosar src=https://6668688.xyz/docs/autosar/images/autosar/2025-07-20-11-21-22.png loading=lazy width=768 height=380>
</picture><a class=post-title href=/docs/autosar/autosar/>Autosar</a><div class="post-meta mb-0">2025年7月9日</div></div></div></div><button class=slide-control-left>
<i class="fas fa-2x fa-chevron-circle-down" data-fa-transform=rotate-90></i>
<span class=visually-hidden>Left</span>
</button>
<button class=slide-control-right>
<i class="fas fa-2x fa-chevron-circle-down" data-fa-transform=rotate-270></i>
<span class=visually-hidden>Right</span></button></div></section><div class="card component row post-comments" id=post-comments><div class=card-header><h2 class="card-title my-2 fs-4 text-surface">评论</h2></div><div class=card-body><div class=giscus></div></div></div></div></div><aside class="sidebar d-flex docs-sidebar col-xxl-3 position-sticky order-xxl-5"><div class=container><div class="accordion post-toc d-none d-lg-block"><div class="accordion-item row mb-4 card component" id=postTOC><div class="card-header accordion-header"><h2 class="card-title fs-4 my-2 text-surface d-none d-lg-block">目录</h2><div class="d-none d-lg-flex gap-2 mb-2"><button id=expand-all-btn class="btn btn-sm btn-outline-primary">展开</button>
<button id=collapse-all-btn class="btn btn-sm btn-outline-secondary">折叠</button></div><a class="accordion-button d-lg-none mb-1 collapsed shadow-none p-0 bg-transparent" role=button data-bs-toggle=collapse href=#post-toc aria-expanded=false aria-controls=post-toc>目录</a></div><div class="card-body collapse accordion-collapse accordion-body d-lg-block" id=post-toc><nav id=post-toc-nav class="nav flex-column"><nav id=TableOfContents><ul><li><a href=#常用命令>常用命令</a><ul><li><a href=#iptable>iptable</a></li></ul></li><li><a href=#wireguard>wireguard</a><ul><li><a href=#openwrt>openwrt</a></li><li><a href=#nanopi-2>NanoPi 2</a></li></ul></li><li><a href=#ddns>ddns</a></li><li><a href=#shellcrash>ShellCrash</a><ul><li><a href=#meta内核>meta内核</a></li><li><a href=#config>config</a></li><li><a href=#fakeip>fakeip</a></li><li><a href=#yamls>yamls</a></li><li><a href=#clashverge>clashverge</a></li></ul></li><li><a href=#ax1800-pro>ax1800 pro</a><ul><li><a href=#刷机>刷机</a></li><li><a href=#优化>优化</a></li></ul></li><li><a href=#ax1800>ax1800</a><ul><li><a href=#串口>串口</a></li><li><a href=#降级解锁ssh>降级解锁ssh</a></li><li><a href=#刷openwrt>刷openwrt</a></li><li><a href=#刷原厂固件>刷原厂固件</a></li></ul></li><li><a href=#ipk下载>ipk下载</a></li><li><a href=#faq>FAQ</a><ul><li><a href=#数据转发异常>数据转发异常</a></li><li><a href=#dns>DNS</a></li></ul></li></ul></nav></nav></div></div></div><script>document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("#post-toc-nav ul li").forEach(function(e){var t,n=e.querySelector("ul");n&&(t=document.createElement("button"),t.textContent="−",t.className="toc-toggle-btn",t.style.marginRight="6px",t.style.background="transparent",t.style.border="none",t.style.cursor="pointer",t.style.fontWeight="bold",t.style.color="#007bff",t.style.padding="0 4px 0 0",t.onclick=function(){n.style.display==="none"?(n.style.display="block",t.textContent="−"):(n.style.display="none",t.textContent="+")},n.style.display="block",e.insertBefore(t,e.firstChild))});const s=document.getElementById("expand-all-btn"),o=document.getElementById("collapse-all-btn");s.addEventListener("click",function(){document.querySelectorAll("#post-toc-nav ul li").forEach(function(e){const t=e.querySelector("ul"),n=e.querySelector("button.toc-toggle-btn");t&&n&&(t.style.display="block",n.textContent="−")})}),o.addEventListener("click",function(){document.querySelectorAll("#post-toc-nav ul li").forEach(function(e){const t=e.querySelector("ul"),n=e.querySelector("button.toc-toggle-btn");t&&n&&(t.style.display="none",n.textContent="+")})});const t=document.querySelectorAll("#post-toc-nav a"),e=[];t.forEach(t=>{const n=t.getAttribute("href");if(n&&n.startsWith("#")){const s=document.getElementById(n.slice(1));s&&e.push({link:t,target:s})}});function n(){let s=window.scrollY||window.pageYOffset;s+=100;let n=null;for(let t=0;t<e.length;t++){const{link:o,target:i}=e[t];if(i.offsetTop<=s)n=o;else break}t.forEach(e=>e.classList.remove("active")),n&&(n.classList.add("active"),n.scrollIntoView({block:"nearest",inline:"nearest"}))}window.addEventListener("scroll",n),n();function i(){function e(t,n=""){let s=1;t.querySelectorAll(":scope > li").forEach(t=>{const o=t.querySelector(":scope > a"),i=n?`${n}.${s}`:`${s}`;if(o){const e=o.textContent.trim();o.textContent=`${i}. ${e}`}const a=t.querySelector(":scope > ul");a&&e(a,i),s++})}const t=document.querySelector("#TableOfContents > ul");t&&e(t)}})</script><style>#post-toc-nav a.active{font-weight:700;color:#856404;background-color:#fff3cd}.toc-toggle-btn{background:0 0;border:none;padding:0 6px 0 0}</style></div></aside></div></main><footer class="footer mt-auto py-3 text-center container"><div class="offcanvas offcanvas-bottom h-auto" tabindex=-1 id=offcanvasActionsPanel aria-labelledby=offcanvasActionsPanelLabel><div class=offcanvas-header><div class="offcanvas-title h5" id=offcanvasActionsPanelLabel><i class="fas fa-fw fa-th-large me-1"></i>
操作</div><button type=button class="btn-close ms-auto" data-bs-dismiss=offcanvas data-bs-target=offcanvasActionsPanel aria-label=Close></button></div><div class="offcanvas-body mt-2"><div class="social-share mb-4 d-flex overflow-auto"><a class="btn-social-share d-flex flex-column align-items-center me-3" rel="noopener noreferrer" aria-label="X Share Button" target=_blank href="https://x.com/intent/tweet?title=Router&url=https%3a%2f%2f6668688.xyz%2fdocs%2fmisc%2frouter%2f"><i class="fab fa-2x fa-fw fa-x-twitter mb-2"></i> X
</a><a class="btn-social-share d-flex flex-column align-items-center me-3" rel="noopener noreferrer" aria-label="Facebook Share Button" target=_blank href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2f6668688.xyz%2fdocs%2fmisc%2frouter%2f"><i class="fab fa-2x fa-fw fa-facebook-f mb-2"></i> Facebook</a></div><hr class=mb-4><div class="actions d-flex overflow-auto align-items-center"><a role=button class="action action-go-back d-flex flex-column align-items-center me-3" href="javascript: window.history.back();"><span class="action-icon mb-2"><i class="fas fa-2x fa-chevron-circle-down" data-fa-transform=rotate-90></i></span> 返回
</a><a role=button class="action action-reload-page d-flex flex-column align-items-center me-3"><span class="action-icon mb-2"><i class="fas fa-2x fa-redo-alt"></i></span> 刷新
</a><a role=button class="action action-copy-url d-flex flex-column align-items-center me-3"><span class="action-icon mb-2"><i class="fas fa-2x fa-link"></i></span> 复制链接</a></div></div></div><div class="row text-center"><div class="col-12 mt-2"><p class=mb-2></p><p class="text-secondary mb-2"><small></small></p><div class="copyright mb-2 text-secondary"><small>Copyright © 2025-2025 zcsaoe. All Rights Reserved.</small></div><div class="powered-by mb-2 text-secondary"><small></small></div><nav class="social-links nav justify-content-center mb-2 mt-3"><a class="nav-link social-link p-0 me-1 mb-2" href=mailto:appleeeeo@protonmail.com title=电子邮箱><i class="fas fa-fw fa-2x fa-envelope" style=color:#0963ac></i>
</a><a class="nav-link social-link p-0 me-1 mb-2" target=_blank href=https://github.com/zcsaoe title=GitHub rel=me><i class="fa-fw fa-2x fab fa-github"></i></a></nav></div><div class="col-12 col-lg-8 offset-0 offset-lg-1"></div></div></footer><script src=/js/plantuml-init.js></script><script data-precache src=/assets/main/bundle.min.308b9e94cdf6f582d972dced59d1ae76c2f26d6c0bc4f02dfa8f9cbcc182cd33.js integrity="sha256-MIuelM329YLZctztWdGudsLybWwLxPAt+o+cvMGCzTM=" crossorigin=anonymous async></script><script data-precache src=/assets/icons/bundle.min.c97d69b111f6a09609591bb9a37c799bba2cae89ca786b5729e53ce6113cb90c.js integrity="sha256-yX1psRH2oJYJWRu5o3x5m7osronKeGtXKeU85hE8uQw=" crossorigin=anonymous defer></script><script data-precache src=/assets/viewer/bundle.min.945567884be417f2aa4a3f7fb0171fc00a214c3c63dd586d110fc7b77d4d6077.js integrity="sha256-lFVniEvkF/KqSj9/sBcfwAohTDxj3VhtEQ/Ht31NYHc=" crossorigin=anonymous defer></script><script src=/js/sw-register.js defer></script><script src=https://giscus.app/client.js data-repo=zcsaoe/zcsaoe.github.io data-repo-id=R_kgDOPDagAg data-category=General data-category-id=DIC_kwDOPDagAs4CsLxl data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous defer></script></body></html>